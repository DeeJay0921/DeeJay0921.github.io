<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>Java中的类型与反射 | DeeJay's Blog</title><meta name="description" content="Java中的类型与反射"><meta name="keywords" content="Java"><meta name="author" content="DeeJay"><meta name="copyright" content="DeeJay"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Java中的类型与反射"><meta name="twitter:description" content="Java中的类型与反射"><meta name="twitter:image" content="https://img.php.cn/upload/article/000/000/040/5e40da5630604732.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Java中的类型与反射"><meta property="og:url" content="https://deejay0921.github.io/2020/01/10/Java中的类型与反射/"><meta property="og:site_name" content="DeeJay's Blog"><meta property="og:description" content="Java中的类型与反射"><meta property="og:image" content="https://img.php.cn/upload/article/000/000/040/5e40da5630604732.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://deejay0921.github.io/2020/01/10/Java中的类型与反射/"><link rel="prev" title="Java8函数式编程" href="https://deejay0921.github.io/2020/01/15/Java8中的函数式编程/"><link rel="next" title="Java多线程爬虫及ElasticSearch的初步使用" href="https://deejay0921.github.io/2020/01/06/Java多线程爬虫及ElasticSearch的初步使用/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'false',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false,
  ClickShowText: undefined,
  medium_zoom: 'false',
  Snackbar: undefined
  
}</script></head><body><div id="header"> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">DeeJay's Blog</a></span><i class="fa fa-bars fa-fw toggle-menu pull_right close" aria-hidden="true"></i><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lazyload avatar_img" src="https://avatars1.githubusercontent.com/u/20784273?s=400&amp;u=ba38b4835b7e3c4960763bc6dce9abb320c43f05&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">159</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">102</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">10</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#类型与反射"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">类型与反射</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Java的类与Class"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">Java的类与Class</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#类加载与ClassLoader"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">类加载与ClassLoader</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Class对象的声明周期"><span class="toc_mobile_items-number">1.2.1.</span> <span class="toc_mobile_items-text">Class对象的声明周期</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Class与ClassLoader"><span class="toc_mobile_items-number">1.2.2.</span> <span class="toc_mobile_items-text">Class与ClassLoader</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#反射"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">反射</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#反射常用API"><span class="toc_mobile_items-number">1.3.1.</span> <span class="toc_mobile_items-text">反射常用API</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#反射的使用举例"><span class="toc_mobile_items-number">1.3.2.</span> <span class="toc_mobile_items-text">反射的使用举例</span></a></li></ol></li></ol></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#类型与反射"><span class="toc-number">1.</span> <span class="toc-text">类型与反射</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Java的类与Class"><span class="toc-number">1.1.</span> <span class="toc-text">Java的类与Class</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#类加载与ClassLoader"><span class="toc-number">1.2.</span> <span class="toc-text">类加载与ClassLoader</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Class对象的声明周期"><span class="toc-number">1.2.1.</span> <span class="toc-text">Class对象的声明周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Class与ClassLoader"><span class="toc-number">1.2.2.</span> <span class="toc-text">Class与ClassLoader</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#反射"><span class="toc-number">1.3.</span> <span class="toc-text">反射</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#反射常用API"><span class="toc-number">1.3.1.</span> <span class="toc-text">反射常用API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#反射的使用举例"><span class="toc-number">1.3.2.</span> <span class="toc-text">反射的使用举例</span></a></li></ol></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://img.php.cn/upload/article/000/000/040/5e40da5630604732.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">Java中的类型与反射</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-01-10<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-03-05</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/">Java</a></span><div class="post-meta-wordcount"><i class="fa fa-eye post-meta__icon" aria-hidden="true">       </i><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><p>本文主要介绍了Java的类与Class定义以及反射及动态调用</p>
<a id="more"></a>

<h1 id="类型与反射"><a href="#类型与反射" class="headerlink" title="类型与反射"></a>类型与反射</h1><h2 id="Java的类与Class"><a href="#Java的类与Class" class="headerlink" title="Java的类与Class"></a>Java的类与Class</h2><p><code>RTTI(Run-Time Type Identification)</code> 运行时类型识别</p>
<p>在<code>Java</code>中，在任何一个时刻，任何一个对象都清楚的知道自己是什么类型的，通过<code>obj.getClass()</code>来获取信息</p>
<p>比如说我是一个接口类型的对象，但是调用<code>obj.getClass()</code>也可以获取到当前对象究竟是这个接口的哪个具体的实现类</p>
<p>一个<code>Class</code>对象就是一个类的说明书, 在开发时，源代码<code>.java</code>文件经过<code>compile</code>变为字节码<code>.class</code>文件</p>
<p>而<code>JVM</code>可以运行这个<code>.class</code>字节码文件,得到一些<code>Class</code>对象，存放在堆中（<code>Java7</code>之前称为永久代PermGen，<code>Java8</code>之后称为元空间MetaSpace）</p>
<p>每当新建一个对象的时候，JVM会在堆里开辟一个空间，然后根据对应的编译好的<code>.class</code>文件来照着其内部实现去创建一个对象</p>
<p>所以说<code>Class</code>对象就是一个类的说明书，在此种情况下，多次创建对象，这些对象都是按照同一份说明书创建出来的</p>
<p>而我们经常使用的<code>static</code>变量，则是归属于这个说明书的，所以才能做到只有一个</p>
<p>而 <code>instanceof</code>方法的本质，就是去调用当前对象的<code>getClass()</code>方法，去和目标类做对比</p>
<p>相似的，当发生强制类型转换时，<code>JVM</code>也清楚的知道当前对象和要转换为的类型，所以如果不能转换的话，就会抛出<code>ClassCastException</code></p>
<h2 id="类加载与ClassLoader"><a href="#类加载与ClassLoader" class="headerlink" title="类加载与ClassLoader"></a>类加载与<code>ClassLoader</code></h2><h3 id="Class对象的声明周期"><a href="#Class对象的声明周期" class="headerlink" title="Class对象的声明周期"></a><code>Class</code>对象的声明周期</h3><p>在第一次被使用时加载，且如果有继承关系的话，比如有这样<code>WhiteCat extends Cat extends Animal</code>的继承关系</p>
<p>那么我们直接<code>new WhiteCat()</code>时，要加载<code>WhiteCat</code>类，必须要先去加载<code>Cat</code>，要加载<code>Cat</code>，就必须先去加载<code>Animal</code></p>
<p>所以加载顺序为<code>Animal -&gt; Cat -&gt; WhiteCat</code></p>
<blockquote>
<p>如果手动执行编译和运行命令的话，在命令行输入<code>-verbose:class</code>可以清晰的看到所以类加载的顺序和信息</p>
</blockquote>
<p>完成一个类的加载过程后，JVM中就会将这个类对应的<code>Class</code>对象放在堆中的Metaspace中，然后就可以根据这个<code>Class</code>对象创建对应的实例对象</p>
<h3 id="Class与ClassLoader"><a href="#Class与ClassLoader" class="headerlink" title="Class与ClassLoader"></a><code>Class</code>与<code>ClassLoader</code></h3><p>上述的加载动作，就是通过<code>ClassLoader</code>来做的</p>
<ul>
<li><p>ClassLoader负责从外部系统中加载一个类</p>
<ul>
<li>这个类对应的Java文件并不一定需要存在（可以凭空的创建一个<code>.class</code>文件而不需要经过<code>.java</code>文件编译得到<code>.class</code>文件）</li>
<li>这个类（即字节码）并不一定需要存在（完全可以通过网络下载等方式得到一个字节流，也完全可以动态生成得到一个字节码）</li>
</ul>
</li>
<li><p>ClassLoader的双亲委派加载模型</p>
</li>
</ul>
<p>每一个<code>ClassLoader</code>对象都有一个<code>parent</code>，每当加载一个外部类的时候，当前<code>ClassLoader</code>对象总是会去询问其父亲是否加载过该类</p>
<p>如果父亲没加载过，自己才会去尝试加载，因为有这种机制，最底层的类，比如<code>Java.lang.String</code>等类都是由最顶端的启动类加载的</p>
<p>这样一来，如果有人也写了一个<code>Java.lang.String</code>，那么在加载时，当前的加载对象会在其父亲处拿到一开始加载的<code>JVM</code>自己的类</p>
<p>保证了安全性</p>
<ul>
<li>Java语言规范与Java虚拟机规范</li>
</ul>
<p>了解到上述的类加载过程以及<code>ClassLoader</code>的特点之后，其实可以发现，<code>JVM</code>其实不需要任何<code>Java</code>代码就可以运行</p>
<p>Java代码和JVM唯一的联系就是字节码，而字节码可以不通过Java代码编译生成</p>
<p>Java语言规范(Java Language Specification，简称JLS) 表明了当前代码是不是合法的Java代码</p>
<p>Java虚拟机规范(Java Virtual Machine Specification,简称JVMS) 则表明了字节码要如何在虚拟机上跑 </p>
<p>这种分离提供了在JVM上运行其他语言的可能（例如Kotlin等）</p>
<h2 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h2><p>我们平常写的新建对象，比如<code>new String(); new ArrayList();</code>等，都是在编译时期就已经确定好要创建什么样的对象了</p>
<p>那么现在有如下场景：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WhiteCat</span> <span class="keyword">extends</span> <span class="title">Cat</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        genarateObjByArg(<span class="string">"java.lang.String"</span>);</span><br><span class="line">        genarateObjByArg(<span class="string">"java.util.ArrayList"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">genarateObjByArg</span> <span class="params">(String className)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 根据参数传递的名字，创建一个对应的对象</span></span><br><span class="line">        <span class="comment">// 比如传入 Java.lang.String 就创建一个String对象 而传入一个Cat 就创建一个Cat对象</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class klass = Class.forName(className); <span class="comment">// class为关键字 所以可以命名为klass clazz等</span></span><br><span class="line">            Object unknownTypeObj = klass.getConstructor().newInstance();</span><br><span class="line">            System.out.println(unknownTypeObj.getClass());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | NoSuchMethodException | InvocationTargetException | InstantiationException | IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述例子达成了一个需求，就是这段代码在执行的时候我们并不知道<code>genarateObjByArg</code>方法里面会生成什么类型的对象</p>
<p>而是<strong>动态的去创建了一个指定类型的对象</strong>。</p>
<p>分析一下上述代码，<code>Class.forName(className)</code>这个方法的注释为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Returns the &#123;@code Class&#125; object associated with the class or interface with the given string name.</span><br></pre></td></tr></table></figure>

<p>即根据指定的<code>string</code>返回<code>MetaSpace</code>中对应的<code>Class</code>对象</p>
<p>拿到这个<code>Class</code>对象之后，就可以使用其内部的成员和方法，比如获取一个无参的构造器，<code>getConstructor()</code>从而创建一个实例对象</p>
<p>这种方式实现，并没有通过传统的<code>new Xxx</code>去创建一个新对象，而是通过一个参数去动态的创建任何能创建的对象</p>
<p>相似的，也可以通过参数动态的决定调用当前对象的哪个方法以及获取对象的成员：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String catName = <span class="string">"MiaoMiao"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">catchMouse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"catchMouse"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">meow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"meow~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">invokeMethodByArg</span><span class="params">(String methodName)</span> </span>&#123;</span><br><span class="line">        Cat cat = <span class="keyword">new</span> Cat();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            cat.getClass().getMethod(methodName).invoke(cat); <span class="comment">// 根据参数动态去决定调用当前cat对象的哪个方法</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException | IllegalAccessException | InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getFieldByArg</span><span class="params">(String fieldName)</span> </span>&#123;</span><br><span class="line">        Cat cat = <span class="keyword">new</span> Cat();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(cat.getClass().getField(fieldName).get(cat)); <span class="comment">// 根据参数动态去获取当前cat对象的成员</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException | NoSuchFieldException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        invokeMethodByArg(<span class="string">"meow"</span>);</span><br><span class="line">        getFieldByArg(<span class="string">"catName"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从上面的例子可以体会出反射的强大</p>
<p>反射在各种框架代码中都有大量应用，比如<code>Spring</code>的源码中就有一个<code>ReflectionUtils</code>类，内部就有着和上面例子相似的工具方法</p>
<h3 id="反射常用API"><a href="#反射常用API" class="headerlink" title="反射常用API"></a>反射常用<code>API</code></h3><ul>
<li>Class<ul>
<li><code>Class.forName()</code></li>
</ul>
</li>
<li>Method<ul>
<li><code>Method.invoke()</code></li>
</ul>
</li>
<li>Field<ul>
<li><code>Field.get()</code></li>
</ul>
</li>
</ul>
<h3 id="反射的使用举例"><a href="#反射的使用举例" class="headerlink" title="反射的使用举例"></a>反射的使用举例</h3><p>在下例中使用反射完成了一个<code>JavaBean</code>到<code>Map</code>的互相转换:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapBeanConverter</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 传入一个遵守Java Bean约定的对象，读取它的所有属性，存储成为一个Map</span></span><br><span class="line">    <span class="comment">// 例如，对于一个DemoJavaBean对象 &#123; id = 1, name = "ABC" &#125;</span></span><br><span class="line">    <span class="comment">// 应当返回一个Map &#123; id -&gt; 1, name -&gt; "ABC", longName -&gt; false &#125;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title">beanToMap</span><span class="params">(Object bean)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 读取传入参数bean的Class  通过反射获得它包含的所有名为getXXX/isXXX，且无参数的方法（即getter方法）</span></span><br><span class="line">        Method[] methods = bean.getClass().getDeclaredMethods();</span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">                <span class="keyword">if</span> (method.getName().startsWith(<span class="string">"get"</span>) || method.getName().startsWith(<span class="string">"is"</span>)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (method.getParameterCount() == <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="comment">// 通过反射调用这些方法并将获得的值存储到Map中返回</span></span><br><span class="line">                        map.put(getFieldNameByMethodName(method.getName()), method.invoke(bean));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getFieldNameByMethodName</span><span class="params">(String methodName)</span> </span>&#123;</span><br><span class="line">        String fieldName = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (methodName.startsWith(<span class="string">"get"</span>)) &#123;</span><br><span class="line">            fieldName = methodName.substring(<span class="number">3</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (methodName.startsWith(<span class="string">"is"</span>)) &#123;</span><br><span class="line">            fieldName = methodName.substring(<span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (fieldName != <span class="keyword">null</span>) &#123;</span><br><span class="line">            fieldName = fieldName.replace(fieldName.charAt(<span class="number">0</span>), Character.toLowerCase(fieldName.charAt(<span class="number">0</span>)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> fieldName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 传入一个遵守Java Bean约定的Class和一个Map，生成一个该对象的实例</span></span><br><span class="line">    <span class="comment">// 传入参数DemoJavaBean.class和Map &#123; id -&gt; 1, name -&gt; "ABC"&#125;</span></span><br><span class="line">    <span class="comment">// 应当返回一个DemoJavaBean对象 &#123; id = 1, name = "ABC" &#125;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">mapToBean</span><span class="params">(Class&lt;T&gt; klass, Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class="line">        T t = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            t = klass.newInstance(); <span class="comment">// 使用反射创建klass对象的一个实例</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException | IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        Set&lt;String&gt; keySet = map.keySet(); <span class="comment">// 遍历map中的所有键值对，寻找klass中名为setXXX，且参数为对应值类型的方法（即setter方法）</span></span><br><span class="line">        <span class="keyword">for</span> (String key : keySet) &#123;</span><br><span class="line">            String methodName = <span class="string">"set"</span> + key.replace(key.charAt(<span class="number">0</span>), Character.toUpperCase(key.charAt(<span class="number">0</span>)));</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 使用反射调用setter方法对该实例的字段进行设值</span></span><br><span class="line">                klass.getMethod(methodName, map.get(key).getClass()).invoke(t, map.get(key));</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IllegalAccessException | InvocationTargetException | NoSuchMethodException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        DemoJavaBean bean = <span class="keyword">new</span> DemoJavaBean();</span><br><span class="line">        bean.setId(<span class="number">100</span>);</span><br><span class="line">        bean.setName(<span class="string">"AAAAAAAAAAAAAAAAAAA"</span>);</span><br><span class="line">        System.out.println(beanToMap(bean));</span><br><span class="line"></span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"id"</span>, <span class="number">123</span>);</span><br><span class="line">        map.put(<span class="string">"name"</span>, <span class="string">"ABCDEFG"</span>);</span><br><span class="line">        System.out.println(mapToBean(DemoJavaBean.class, map));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoJavaBean</span> </span>&#123;</span><br><span class="line">        Integer id;</span><br><span class="line">        String name;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> id;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.id = id;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLongName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> name.length() &gt; <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"DemoJavaBean&#123;"</span></span><br><span class="line">                    + <span class="string">"id="</span></span><br><span class="line">                    + id</span><br><span class="line">                    + <span class="string">", name='"</span></span><br><span class="line">                    + name</span><br><span class="line">                    + <span class="string">'\''</span></span><br><span class="line">                    + <span class="string">", longName="</span></span><br><span class="line">                    + isLongName()</span><br><span class="line">                    + <span class="string">'&#125;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">DeeJay</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://deejay0921.github.io/2020/01/10/Java中的类型与反射/">https://deejay0921.github.io/2020/01/10/Java中的类型与反射/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://deejay0921.github.io">DeeJay's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java    </a></div><div class="post_share"><div class="social-share" data-image="https://img.php.cn/upload/article/000/000/040/5e40da5630604732.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/01/15/Java8中的函数式编程/"><img class="prev_cover lazyload" data-src="https://upload-images.jianshu.io/upload_images/16323523-273fc82a9a74ced8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>Java8函数式编程</span></div></a></div><div class="next-post pull_right"><a href="/2020/01/06/Java多线程爬虫及ElasticSearch的初步使用/"><img class="next_cover lazyload" data-src="http://allzhere.in/wp-content/uploads/2013/05/Java_Multithreading_Live_Scenario.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Java多线程爬虫及ElasticSearch的初步使用</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2018/07/18/Java中的面向对象的简单介绍（三）继承及abstract抽象类/" title="Java中的面向对象的简单介绍（三）继承及abstract抽象类"><img class="relatedPosts_cover lazyload" data-src="https://revistadigital.inesem.es/informatica-y-tics/files/2015/10/inesem-java-1024x768.jpg"><div class="relatedPosts_title">Java中的面向对象的简单介绍（三）继承及abstract抽象类</div></a></div><div class="relatedPosts_item"><a href="/2019/07/22/Collection体系原理了解/" title="Collection体系原理了解"><img class="relatedPosts_cover lazyload" data-src="https://marcus-biel.com/wp-content/uploads/2015/08/class-and-interface-hierarchy.png"><div class="relatedPosts_title">Collection体系原理了解</div></a></div><div class="relatedPosts_item"><a href="/2019/09/02/Java-File类详解及IO介绍及使用/" title="Java-File类详解及IO介绍及使用"><img class="relatedPosts_cover lazyload" data-src="https://revistadigital.inesem.es/informatica-y-tics/files/2015/10/inesem-java-1024x768.jpg"><div class="relatedPosts_title">Java-File类详解及IO介绍及使用</div></a></div><div class="relatedPosts_item"><a href="/2019/02/22/Java-集合与泛型/" title="Java-集合与泛型"><img class="relatedPosts_cover lazyload" data-src="https://revistadigital.inesem.es/informatica-y-tics/files/2015/10/inesem-java-1024x768.jpg"><div class="relatedPosts_title">Java-集合与泛型</div></a></div><div class="relatedPosts_item"><a href="/2020/01/15/Java8中的函数式编程/" title="Java8函数式编程"><img class="relatedPosts_cover lazyload" data-src="https://upload-images.jianshu.io/upload_images/16323523-273fc82a9a74ced8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><div class="relatedPosts_title">Java8函数式编程</div></a></div><div class="relatedPosts_item"><a href="/2018/12/26/Java中的IO和流/" title="Java中的IO和流"><img class="relatedPosts_cover lazyload" data-src="https://revistadigital.inesem.es/informatica-y-tics/files/2015/10/inesem-java-1024x768.jpg"><div class="relatedPosts_title">Java中的IO和流</div></a></div></div><div class="clear_both"></div></div></div></div><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2020 By DeeJay</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async></script></body></html>