<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content>
  <meta name="author" content="DeeJay">
  <!-- Open Graph Data -->
  <meta property="og:title" content="npm">
  <meta property="og:description" content="web前端 Java后端">
  <meta property="og:site_name" content="DeeJay&#39;s Blog">
  <meta property="og:type" content="article">
  <meta property="og:image" content="https://deejay0921.github.io">
  
    <link rel="alternate" href="/atom.xml" title="DeeJay&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.jpg">
  

  <!-- Site Title -->
  <title>DeeJay's Blog</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.light.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/img/blog-banner2.png)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">npm</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/DeeJay0921">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:1018805743@qq.com">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>

<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By DeeJay</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2017-09-02</span>
            <span class="time">01:29:23</span>
          </span>
          
          <!--  Categories  -->
            <span class="categories info">Under 

<a href="/categories/前端/">前端</a>
</span>
          
        </div>
        <!-- Tags -->
        
          <div class="post-tags text-muted">
            Tags: 

<a class="tag" href="/tags/前端/">#前端</a> <a class="tag" href="/tags/JS/">#JS</a> <a class="tag" href="/tags/JS-module/">#JS module</a> <a class="tag" href="/tags/npm/">#npm</a>


          </div>
        
        <!-- Post Main Content -->
        <div class="post-content">
          <p>Node Packcge Manager,node包管理器，主要功能是管理node包的安装，卸载，更新，查看，搜索，发布等。</p>
<a id="more"></a>

<p>##npm是什么<br>Node Packcge Manager,node包管理器，主要功能是管理node包的安装，卸载，更新，查看，搜索，发布等。</p>
<p><a href="https://www.npmjs.com" target="_blank" rel="noopener">npm官网</a></p>
<p>##npm包的命令行指令<br>node包的安装分为<strong>本地安装</strong>和<strong>全局安装</strong></p>
<ul>
<li><p>本地安装：<code>npm install pkg</code><br>package会被下载到当前所在目录，也只能在当前目录下使用</p>
</li>
<li><p>全局安装： <code>npm install -g pkg</code><br>package会被下载到特定的系统目录下，安装的package能够在所有目录下使用</p>
</li>
</ul>
<p>安装之后，会在当前目录出现一个node_modules文件夹，当我们require(‘模块名’)的时候，会先在当前目录下的node_modules文件夹下去找package.json文件中的main属性对应的参数js文件。去加载这个js文件作为模块。如果当前目录找不到node_modules就会向上一级去寻找到根目录.</p>
<ul>
<li><strong>npm install pkg –save</strong><br>自己要发布新的包，并且自己发布的包中引用了别人的包的时候，就要使用这个指令将别人的包下载下来，这条指令会使得package.json中多一个dependencies的属性，包含了引用的包的名字以及版本号。这样，别人在使用我们自己发布的包的时候，不需要将我们的包中引用的包一个个下载下来，直接使用<strong>npm install</strong>就能安装所有引用的模块。</li>
<li><strong>npm install –save-dev pkg</strong><br>我们使用上述指令，package.json中会多一个devDependencies属性，这个属性中一般是自己在做开发测试的时候用的测试工具，别人引用的时候不会用到。当别人使用你的包时，进行<code>npm install</code>时，npm会把dependencies中的模块也一起下载下来，而不会把devDependencies的模块下载下来。</li>
</ul>
<p>##几个demo演示npm的用法</p>
<ul>
<li><strong>demo1  一般模块之间的引用</strong>：<br>a.js:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// var aSayHello = require(&apos;./b&apos;);//得到的是exports对象，此时aSayHello不是一个函数，所以要写成</span><br><span class="line">var aSayHello = require(&apos;./b&apos;).bSay; // 获取到的是exports对象，这个exports对象的bSay属性才是在b.js中定义的bSayHello函数</span><br><span class="line">aSayHello();</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>b:js:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var bSayHello =  function () &#123;</span><br><span class="line">    console.log(&apos;hello deejay&apos;);</span><br><span class="line">&#125;</span><br><span class="line">exports.bSay = bSayHello;</span><br></pre></td></tr></table></figure>

<p>demo1里的注意事项，我们require得到的是exports这个对象，要使用赋给exports对象的属性，那就还要写上属性。另外require(‘./a’)和require(‘./a.js’)都是可以的，但是写成require(‘a’)就是不对的。</p>
<ul>
<li><strong>demo2   引用外部的包：</strong><br>demo2有个实际需求，把markdown格式的文档转化为html格式的文档,我们需要使用外部的node包，进入<a href="https://www.npmjs.com" target="_blank" rel="noopener">npm官网</a>,搜索相关工具，比如搜索marked，使用npm下载<code>npm install marked</code>,安装完成之后</li>
</ul>
<p>a.js:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//根据文档用法来进行使用</span><br><span class="line">var aMarked = require(&apos;marked&apos;);</span><br><span class="line">var str = aMarked(&apos;# hello&apos;);</span><br><span class="line">console.log(str);</span><br></pre></td></tr></table></figure>

<p>demo2中的require(‘marked’)，其中模块名就是npm安装的模块名，运行的时候会先在当前目录的node_modules文件夹下去找这个模块，如果找不到再去上一级目录去找，直到找到为止</p>
<ul>
<li><strong>demo3    自己发布包以及引用别人的包，–save：</strong><br>demo3的需求是，自己创建一个包，这个包引用别人的包，并且自己也要可以发布给别人使用。想发布的话，就要写package.json，可以直接npm init,可以依次输入自己创建的包的各项信息。这样就创建好了package.json。然后写好readme.md，再去创建index.js<br>index.js:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var marked = require(&apos;marked&apos;);</span><br><span class="line">var str = marked(&apos;# hello deejay&apos;);</span><br><span class="line">console.log(str);</span><br><span class="line"></span><br><span class="line">module.exports = str;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>module.exports就是我们暴露出来可以给别人使用的东西。另外我们是在package.json中的main中指定了比人是从index.js中读取的，所以在index.js中写代码。那么我们在demo3中用到了marked的包，这个包是别人的，所以我们需要进行测试，将marked包下载下来，但是指令不一样，指令写成：<strong>npm install –save marked</strong>，下载下来我们发现package.json中多了dependencies的属性，包含了引用的包的名字以及版本号。这样，别人在使用我们自己发布的包的时候，不需要将我们的包中引用的包一个个下载下来，直接使用<strong>npm install</strong>就能安装所有引用的模块。<br>上传的时候，使用<strong>npm login</strong>来进行登录，然后进行<strong>npm publish</strong>上传我们的包</p>
<ul>
<li><strong>demo4   全局安装，实现一个命令行工具：</strong><br>demo4要实现一个命令行工具，在任何目录下都能实现。要使用npm install -g.</li>
</ul>
<p>a.js:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env node</span><br><span class="line"></span><br><span class="line">console.log(&apos;hello&apos;);</span><br></pre></td></tr></table></figure>

<p>#!/usr/bin/env node代表指明要用node来执行当前的文件。<br>设置package.json,添加bin属性<br>package.json:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;deejay-demo&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;print &apos;&apos;\u001b[Dhello&apos;&quot;,</span><br><span class="line">  &quot;main&quot;: &quot;./a.js&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;bin&quot;: &#123;</span><br><span class="line">    &quot;deejay&quot;: &quot;./a.js&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;author&quot;: &quot;deejay&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;ISC&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>bin属性中的deejay代表之后命令行的指令，发布之后全局安装到本地之后只需要输入deejay就会使用node运行”./a.js”。<br>安装时提示有：<br>C:\Users\DeeJay_Y\AppData\Roaming\npm\deejay -&gt; C:\Users\DeeJay_Y\AppData\Roaming\npm\node_modules\deejay-demo\a.js<br>那么C:\Users\DeeJay_Y\AppData\Roaming\npm\node_modules就全是全局命令行工具所在的地方，npm install -g就是安装到这里的。<br>注意：这里的全局安装之后，如果不是在当前目录下的文件的话，<strong>要使用模块的话是require不到的</strong>。因为require只会在当前目录一级一级直到跟目录，是找不到-g下的目录的。</p>
<ul>
<li><strong>demo5    发布一个天气预报的命令行工具：</strong><br>当用户输入weather时，得到本地的天气，当用户输入weather 目标城市 的时候，得到目标城市的天气。<br>要想知道用户输入的目标城市，要用到process.argv。<br>####process.argv<br>process模块用来与当前进程互动，可以通过全局变量process访问，不必使用require命令加载。它是一个EventEmitter对象的实例。</li>
</ul>
<p>process.argv返回命令行脚本的各个参数组成的数组。</p>
<p>先初始化package.json,然后加个bin属性：<br>package.json</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;deejay-weather&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;&apos;weather-forecast&apos;&quot;,</span><br><span class="line">  &quot;main&quot;: &quot;./weather.js&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;bin&quot;: &#123;</span><br><span class="line">    &quot;weather&quot;: &quot;./weather.js&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;author&quot;: &quot;deejay&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;ISC&quot;,</span><br><span class="line">  &quot;keywords&quot;: [</span><br><span class="line">    &quot;weather&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;axios&quot;: &quot;^0.16.2&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>weather.js:</p>
<p>使用axios来发送请求获得数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env node</span><br><span class="line"></span><br><span class="line">var axios = require(&apos;axios&apos;);</span><br><span class="line">// console.log(process.argv); // process.argv[2]代表了当前用户输入的weather 后面的目标城市</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var data = &#123;&#125;; //用来存储用户输入的目标城市的天气</span><br><span class="line">if (process.argv[2]) &#123; // 即如果用户输入了目标城市的话</span><br><span class="line">    data.params = &#123;</span><br><span class="line">        city: process.argv[2],</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">axios.get(&apos;http://api.jirengu.com/weather.php&apos;, data)</span><br><span class="line">    .then(function (response) &#123;</span><br><span class="line">        var weather = response.data.results[0].weather_data[0];</span><br><span class="line">        console.log(response.data.results[0].currentCity);</span><br><span class="line">        console.log(&apos;pm2.5: &apos; + response.data.results[0].pm25);</span><br><span class="line">        console.log(weather.date);</span><br><span class="line">        console.log(weather.temperature);</span><br><span class="line">        console.log(weather.weather);</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(function (error) &#123;</span><br><span class="line">        console.log(error);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<p>###PS：关于package.json中的script。</p>
<p>可以执行一些全局的代码或者是命令行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;echo deejay&quot;,</span><br><span class="line">    &quot;start&quot;: &quot;echo hello&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>其中test和start是默认的，可以直接通过npm test和npm start来运行。<br>但是如果要添加新的命令，如build,就只能通过npm run build来运行。</p>

        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

